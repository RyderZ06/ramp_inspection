Пошаговая инструкция подключения SQLite3 к Power BI через ODBC:

1. Установка драйвера ODBC для SQLite
Скачайте и установите SQLite ODBC драйвер,
соответствующий разрядности вашей системы (32-бит или 64-бит).
Для Power BI Desktop обычно нужна 64-бит версия драйвера.

Для установки ODBC-драйвера для SQLite на вашем компьютере выполните следующие шаги:
1.1. Откройте веб-браузер и перейдите на официальный сайт драйвера SQLite ODBC:
http://www.ch-werner.de/sqliteodbc/

1.2. Выберите версию драйвера, соответствующую архитектуре вашей системы:
Для 64-битной Windows скачайте файл sqliteodbc_w64.exe
Для 32-битной Windows - sqliteodbc.exe

1.3. Скачайте выбранный установочный файл на компьютер.
1.4. Запустите скачанный файл двойным кликом.
При появлении запроса контроля учетных записей (UAC)
подтвердите запуск с правами администратора.

1.5. В установщике нажимайте "Next" (Далее),
соглашайтесь с лицензионным соглашением
и оставляйте пути установки по умолчанию.
Обычно не требуется выбирать дополнительные компоненты.

1.6. Дождитесь завершения установки и нажмите "Finish" (Завершить).

1.7. Убедитесь, что драйвер установлен корректно:
откройте "Администрирование источников данных ODBC" (ODBC Data Source Administrator)
и на вкладке "Драйверы" найдите "SQLite3 ODBC Driver" или "SQLite ODBC Driver".

2. Создание ODBC источника данных (DSN)
В "Администрировании источников данных ODBC"
перейдите на вкладку "Пользовательские DSN" (User DSN)
и нажмите "Добавить".

Выберите "SQLite3 ODBC Driver" и нажмите "Готово".

В появившемся окне задайте имя источника данных (например, "SQLite_DB")
и нажмите "Обзор", чтобы выбрать файл вашей базы данных SQLite (.sqlite или .db).

Подтвердите выбор и сохраните DSN.

3. Подключение к базе SQLite из Power BI
Запустите Power BI Desktop.

Нажмите "Получить данные" (Get Data) → выберите "Другие" (Other) → "ODBC"
и нажмите "Подключить" (Connect).

В списке источников ODBC выберите созданный DSN
(например, "SQLite_DB") и нажмите "ОК".

В появившемся окне выберите таблицы, которые хотите импортировать,
и нажмите "Загрузить" (Load).

После загрузки данных в Power BI создайте необходимые связи
между таблицами вручную в разделе "Модель" (Model).

4. Дополнительные рекомендации
Если при подключении возникает ошибка "SQLSetConnectAttr failed",
проверьте, нет ли триггеров в таблицах SQLite
- иногда они вызывают проблемы с драйвером.
При необходимости временно удалите триггеры.

Убедитесь, что разрядность драйвера совпадает
с разрядностью Power BI (обычно 64-бит).

Для обновления данных в Power BI используйте режим импорта,
так как Direct Query с SQLite через ODBC не поддерживается.
